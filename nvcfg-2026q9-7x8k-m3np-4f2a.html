<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NVCBO Donations Setup Configurator | Internal Tool</title>
    <!-- Prevent indexing -->
    <meta name="robots" content="noindex, nofollow">
    <meta name="googlebot" content="noindex, nofollow">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* NVCBO Orange Theme Variables */
        :root {
            --nv-orange-primary: #FF8C00;
            --nv-orange-mid: #FF7F00;
            --nv-orange-burnt: #CC5500;
            --nv-orange-rust: #B7410E;
            --nv-cream: #FFF5E6;
            --nv-dark: #1a1a2e;
            --nv-darker: #16162b;
        }

        body {
            background: linear-gradient(135deg, var(--nv-dark) 0%, var(--nv-darker) 100%);
            min-height: 100vh;
        }

        /* Password Gate Styles */
        #password-gate {
            position: fixed;
            inset: 0;
            z-index: 9999;
            background: linear-gradient(135deg, var(--nv-dark) 0%, var(--nv-darker) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #password-gate.hidden {
            display: none;
        }

        .gate-card {
            background: rgba(255, 140, 0, 0.08);
            border: 2px solid rgba(255, 140, 0, 0.3);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 3rem;
            max-width: 420px;
            width: 90%;
            text-align: center;
        }

        .gate-input {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 140, 0, 0.3);
            color: white;
            padding: 1rem;
            border-radius: 10px;
            width: 100%;
            font-size: 1rem;
            text-align: center;
            letter-spacing: 3px;
        }

        .gate-input:focus {
            outline: none;
            border-color: var(--nv-orange-primary);
            box-shadow: 0 0 20px rgba(255, 140, 0, 0.3);
        }

        .gate-btn {
            background: linear-gradient(135deg, var(--nv-orange-primary) 0%, var(--nv-orange-burnt) 100%);
            border: none;
            color: white;
            padding: 1rem 2rem;
            border-radius: 50px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-top: 1rem;
            transition: all 0.3s ease;
        }

        .gate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255, 140, 0, 0.4);
        }

        .gate-error {
            color: #ef4444;
            font-size: 0.85rem;
            margin-top: 0.5rem;
            display: none;
        }

        .gate-error.show {
            display: block;
            animation: shake 0.5s ease;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        /* Hide main content until authenticated */
        #main-content {
            display: none;
        }

        #main-content.unlocked {
            display: block;
        }

        .config-card {
            background: rgba(255, 140, 0, 0.08);
            border: 1px solid rgba(255, 140, 0, 0.2);
            backdrop-filter: blur(10px);
        }

        .config-card:hover {
            border-color: var(--nv-orange-primary);
            box-shadow: 0 0 20px rgba(255, 140, 0, 0.15);
        }

        .option-btn {
            background: rgba(255, 140, 0, 0.1);
            border: 1px solid rgba(255, 140, 0, 0.3);
            transition: all 0.3s ease;
        }

        .option-btn:hover {
            background: rgba(255, 140, 0, 0.2);
            border-color: var(--nv-orange-primary);
        }

        .option-btn.selected {
            background: linear-gradient(135deg, var(--nv-orange-primary) 0%, var(--nv-orange-burnt) 100%);
            border-color: var(--nv-orange-primary);
            box-shadow: 0 0 15px rgba(255, 140, 0, 0.4);
        }

        .section-header {
            background: linear-gradient(90deg, var(--nv-orange-primary), var(--nv-orange-burnt));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .output-box {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 140, 0, 0.3);
        }

        .copy-btn {
            background: linear-gradient(135deg, var(--nv-orange-primary) 0%, var(--nv-orange-burnt) 100%);
        }

        .copy-btn:hover {
            background: linear-gradient(135deg, var(--nv-orange-mid) 0%, var(--nv-orange-rust) 100%);
            box-shadow: 0 0 20px rgba(255, 140, 0, 0.4);
        }

        .manifest-btn {
            background: linear-gradient(135deg, var(--nv-orange-burnt) 0%, var(--nv-orange-rust) 100%);
        }

        .manifest-btn:hover {
            background: linear-gradient(135deg, var(--nv-orange-primary) 0%, var(--nv-orange-burnt) 100%);
        }

        .tag-badge {
            background: rgba(255, 140, 0, 0.2);
            color: var(--nv-orange-primary);
        }

        .tooltip-custom {
            background: var(--nv-darker);
            border: 1px solid var(--nv-orange-primary);
        }

        /* Logo breathing animation */
        .logo-cbo {
            animation: cbo-breathe 3s ease-in-out infinite;
        }

        @keyframes cbo-breathe {
            0%, 100% { opacity: 0.7; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.05); }
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--nv-darker);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--nv-orange-burnt);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--nv-orange-primary);
        }

        /* Internal badge */
        .internal-badge {
            background: linear-gradient(135deg, #dc2626, #991b1b);
            animation: pulse-badge 2s ease-in-out infinite;
        }

        @keyframes pulse-badge {
            0%, 100% { box-shadow: 0 0 5px rgba(220, 38, 38, 0.5); }
            50% { box-shadow: 0 0 15px rgba(220, 38, 38, 0.8); }
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .modal-overlay.active {
            display: flex;
            animation: fadeIn 0.2s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-card {
            background: linear-gradient(135deg, var(--nv-dark) 0%, var(--nv-darker) 100%);
            border: 2px solid var(--nv-orange-primary);
            border-radius: 20px;
            padding: 2rem;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-input {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 140, 0, 0.3);
            color: white;
            padding: 0.75rem 1rem;
            border-radius: 10px;
            width: 100%;
            font-size: 0.95rem;
            transition: all 0.2s ease;
        }

        .modal-input:focus {
            outline: none;
            border-color: var(--nv-orange-primary);
            box-shadow: 0 0 15px rgba(255, 140, 0, 0.2);
        }

        .modal-input::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        .modal-label {
            color: var(--nv-orange-primary);
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: block;
        }

        .modal-btn {
            background: linear-gradient(135deg, var(--nv-orange-primary) 0%, var(--nv-orange-burnt) 100%);
            border: none;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(255, 140, 0, 0.4);
        }

        .modal-btn-cancel {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: rgba(255, 255, 255, 0.7);
        }

        .modal-btn-cancel:hover {
            border-color: #ef4444;
            color: #ef4444;
            box-shadow: none;
            transform: none;
        }

        /* Status indicator on selected items */
        .config-status {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 20px;
            height: 20px;
            background: #22c55e;
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: white;
            border: 2px solid var(--nv-dark);
        }

        .option-btn.configured .config-status {
            display: flex;
        }

        .option-btn {
            position: relative;
        }

        /* ========== MOBILE RESPONSIVE STYLES ========== */
        
        /* Extra small devices (phones, 480px and below) */
        @media (max-width: 480px) {
            body {
                padding: 0.5rem;
            }
            
            .gate-card {
                padding: 1.5rem;
                border-radius: 16px;
            }
            
            .gate-card h2 {
                font-size: 1.25rem;
            }
            
            .gate-input {
                padding: 0.75rem;
                font-size: 0.9rem;
                letter-spacing: 2px;
            }
            
            .gate-btn {
                padding: 0.75rem 1.5rem;
                font-size: 0.9rem;
            }
            
            /* Internal banner */
            .internal-badge {
                display: none;
            }
            
            .fixed.top-0 span.text-sm {
                font-size: 0.7rem;
            }
            
            /* Header */
            .max-w-6xl {
                padding-left: 0.5rem;
                padding-right: 0.5rem;
            }
            
            h1.text-4xl {
                font-size: 1.5rem !important;
            }
            
            h1 sup {
                font-size: 0.65rem !important;
            }
            
            h2.text-2xl {
                font-size: 1.1rem !important;
            }
            
            .text-center.mb-12 p {
                font-size: 0.8rem;
                padding: 0 0.5rem;
            }
            
            /* Config cards */
            .config-card {
                padding: 1rem;
                border-radius: 16px;
            }
            
            .config-card h3 {
                font-size: 1rem;
            }
            
            /* Option buttons - compact for mobile */
            .option-btn {
                padding: 0.625rem !important;
                gap: 0.5rem !important;
                border-radius: 0.5rem !important;
            }
            
            .option-btn > div:first-of-type {
                width: 1.75rem !important;
                height: 1.75rem !important;
                min-width: 1.75rem !important;
                flex-shrink: 0;
            }
            
            .option-btn > div:first-of-type i {
                font-size: 0.7rem !important;
            }
            
            .option-btn .font-medium {
                font-size: 0.8rem;
            }
            
            .option-btn p,
            .option-btn .text-xs:not(.tag-badge) {
                font-size: 0.6rem !important;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                max-width: 100px;
            }
            
            .option-btn .flex-1 {
                min-width: 0;
                overflow: hidden;
            }
            
            .tag-badge {
                font-size: 0.5rem !important;
                padding: 0.1rem 0.3rem !important;
                white-space: nowrap;
            }
            
            /* Output section */
            .output-box {
                padding: 0.75rem;
            }
            
            .output-box pre {
                font-size: 0.65rem;
            }
            
            /* Action buttons - stack vertically */
            .flex.gap-2 button {
                padding: 0.5rem 0.75rem;
                font-size: 0.75rem;
            }
            
            .flex.gap-2 button span,
            .flex.gap-2 button .hidden-mobile {
                display: none;
            }
            
            /* Modal */
            .modal-card {
                padding: 1.25rem;
                margin: 0.5rem;
                max-height: 85vh;
            }
            
            .modal-card h3 {
                font-size: 1rem;
            }
            
            #modal-icon {
                width: 2.5rem !important;
                height: 2.5rem !important;
            }
            
            #modal-icon i {
                font-size: 1rem !important;
            }
            
            .modal-input {
                padding: 0.6rem 0.75rem;
                font-size: 0.85rem;
            }
            
            .modal-label {
                font-size: 0.75rem;
            }
            
            .modal-btn {
                padding: 0.6rem 1rem;
                font-size: 0.85rem;
            }
            
            /* Config status indicator */
            .config-status {
                width: 16px;
                height: 16px;
                font-size: 8px;
                top: -3px;
                right: -3px;
            }
        }
        
        /* Small devices (landscape phones, 481px to 640px) */
        @media (min-width: 481px) and (max-width: 640px) {
            body {
                padding: 0.75rem;
            }
            
            .config-card {
                padding: 1.25rem;
            }
            
            .option-btn {
                padding: 0.875rem !important;
            }
            
            .option-btn .text-xs.text-gray-400 {
                display: -webkit-box;
                -webkit-line-clamp: 1;
                line-clamp: 1;
                -webkit-box-orient: vertical;
                overflow: hidden;
            }
            
            .modal-card {
                padding: 1.5rem;
            }
        }
        
        /* Medium devices (tablets, 641px to 768px) */
        @media (min-width: 641px) and (max-width: 768px) {
            .grid.md\:grid-cols-2 {
                grid-template-columns: 1fr;
            }
            
            .config-card {
                padding: 1.5rem;
            }
        }
        
        /* Touch-friendly improvements */
        @media (hover: none) and (pointer: coarse) {
            .option-btn {
                min-height: 56px;
            }
            
            .gate-btn,
            .modal-btn,
            .copy-btn,
            .manifest-btn {
                min-height: 48px;
            }
            
            /* Larger touch targets */
            button {
                cursor: pointer;
                -webkit-tap-highlight-color: rgba(255, 140, 0, 0.2);
            }
        }
        
        /* Landscape phone orientation */
        @media (max-height: 500px) and (orientation: landscape) {
            .modal-card {
                max-height: 95vh;
                padding: 1rem;
            }
            
            .modal-card .space-y-4 {
                gap: 0.5rem;
            }
            
            #password-gate .gate-card {
                padding: 1.5rem;
            }
        }
        
        /* Safe area for notched phones */
        @supports (padding-top: env(safe-area-inset-top)) {
            .fixed.top-0 {
                padding-top: env(safe-area-inset-top);
            }
            
            body {
                padding-left: env(safe-area-inset-left);
                padding-right: env(safe-area-inset-right);
                padding-bottom: env(safe-area-inset-bottom);
            }
        }
    </style>
</head>
<body class="text-white p-3 sm:p-4 md:p-6">
    
    <!-- ========== PASSWORD GATE (Layer 2) ========== -->
    <div id="password-gate">
        <div class="gate-card">
            <div class="w-12 h-12 sm:w-16 sm:h-16 rounded-full bg-gradient-to-br from-orange-500 to-orange-700 flex items-center justify-center mx-auto mb-3 sm:mb-4">
                <i class="fas fa-lock text-white text-lg sm:text-2xl"></i>
            </div>
            <h2 class="text-xl sm:text-2xl font-bold text-white mb-1.5 sm:mb-2">Restricted Access</h2>
            <p class="text-gray-400 text-xs sm:text-sm mb-4 sm:mb-6">
                This internal tool requires authorization.<br>
                Enter the PROJECT_SECRET to continue.
            </p>
            <input 
                type="password" 
                id="gate-password" 
                class="gate-input" 
                placeholder="• • • • • • • •"
                autocomplete="off"
                onkeypress="if(event.key==='Enter') checkPassword()"
            >
            <p id="gate-error" class="gate-error">
                <i class="fas fa-exclamation-triangle mr-1"></i> Invalid secret. Access denied.
            </p>
            <button class="gate-btn" onclick="checkPassword()">
                <i class="fas fa-unlock-alt mr-2"></i> Unlock Configurator
            </button>
            <p class="text-gray-600 text-xs mt-4">
                <i class="fas fa-shield-alt mr-1"></i> All access attempts are logged
            </p>
        </div>
    </div>

    <!-- ========== MAIN CONTENT (hidden until authenticated) ========== -->
    <div id="main-content">
    
    <!-- Internal Use Banner -->
    <div class="fixed top-0 left-0 right-0 bg-red-900/90 text-white text-center py-1.5 sm:py-2 z-50 backdrop-blur-sm px-2">
        <span class="internal-badge px-2 sm:px-3 py-0.5 sm:py-1 rounded-full text-[10px] sm:text-xs font-bold mr-1 sm:mr-2 hidden xs:inline">INTERNAL</span>
        <span class="text-[11px] sm:text-sm truncate">NVCBO Staff Only — Q9/2026</span>
    </div>

    <div class="max-w-6xl mx-auto pt-10 sm:pt-12 px-1 sm:px-2">
        
        <!-- Header -->
        <div class="text-center mb-6 sm:mb-8 md:mb-12">
            <div class="flex items-center justify-center gap-2 sm:gap-3 mb-3 sm:mb-4">
                <div class="w-9 h-9 sm:w-10 md:w-12 sm:h-10 md:h-12 rounded-full bg-gradient-to-br from-orange-500 to-orange-700 flex items-center justify-center flex-shrink-0">
                    <i class="fas fa-hand-holding-heart text-white text-base sm:text-lg md:text-xl"></i>
                </div>
                <h1 class="text-xl sm:text-2xl md:text-4xl font-bold">
                    <span class="text-white">Northern Vision</span><sup class="logo-cbo text-orange-400 text-[10px] sm:text-sm md:text-lg ml-0.5 sm:ml-1">CBO</sup>
                </h1>
            </div>
            <h2 class="section-header text-base sm:text-xl md:text-2xl font-semibold mb-1 sm:mb-2">Donations Setup Configurator</h2>
            <p class="text-gray-400 max-w-2xl mx-auto text-xs sm:text-sm md:text-base px-2">
                Internal planning tool for configuring our donation infrastructure. 
                <span class="hidden sm:inline">Select your preferred options below to generate a configuration manifest for development.</span>
            </p>
        </div>

        <!-- Configuration Sections -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-3 sm:gap-4 md:gap-6 mb-4 sm:mb-6 md:mb-8">
            
            <!-- Payment Gateways -->
            <div class="config-card rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-6 transition-all duration-300">
                <div class="flex items-center gap-2 sm:gap-3 mb-3 sm:mb-4">
                    <div class="w-8 h-8 sm:w-10 sm:h-10 rounded-lg bg-orange-500/20 flex items-center justify-center flex-shrink-0">
                        <i class="fas fa-credit-card text-orange-400 text-sm sm:text-base"></i>
                    </div>
                    <div>
                        <h3 class="text-sm sm:text-base md:text-lg font-semibold text-white">Payment Gateways</h3>
                        <p class="text-[10px] sm:text-xs text-gray-400">Select all that apply (14 options)</p>
                    </div>
                </div>
                <div class="space-y-3">
                    <button onclick="toggleOption(this, 'gateways', 'mpesa')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-green-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-mobile-alt text-green-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">M-Pesa</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Safaricom mobile money</p>
                        </div>
                        <span class="tag-badge px-1.5 sm:px-2 py-0.5 sm:py-1 rounded text-[10px] sm:text-xs flex-shrink-0">Recommended</span>
                    </button>
                    
                    <button onclick="toggleOption(this, 'gateways', 'paypal')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-blue-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fab fa-paypal text-blue-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">PayPal</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">International donors & diaspora</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'gateways', 'stripe')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-purple-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fab fa-stripe-s text-purple-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Stripe</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Cards, Apple Pay, Google Pay</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'gateways', 'flutterwave')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-orange-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-bolt text-orange-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Flutterwave</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Pan-African payment gateway</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'gateways', 'mchanga')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-teal-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-hand-holding-heart text-teal-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">M-Changa</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Kenyan crowdfunding platform</p>
                        </div>
                        <span class="tag-badge px-1.5 sm:px-2 py-0.5 sm:py-1 rounded text-[10px] sm:text-xs flex-shrink-0">Local</span>
                    </button>
                    
                    <button onclick="toggleOption(this, 'gateways', 'payhero')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-indigo-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-rocket text-indigo-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">PayHero Kenya</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Local payment aggregator</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'gateways', 'pesapal')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-red-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-shield-alt text-red-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Pesapal</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Multi-channel East African gateway</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'gateways', 'globalgiving')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-emerald-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-globe-africa text-emerald-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">GlobalGiving</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Vetted nonprofit fundraising</p>
                        </div>
                        <span class="tag-badge px-1.5 sm:px-2 py-0.5 sm:py-1 rounded text-[10px] sm:text-xs flex-shrink-0">International</span>
                    </button>
                    
                    <button onclick="toggleOption(this, 'gateways', 'gofundme')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-lime-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-heart text-lime-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">GoFundMe</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Global crowdfunding campaigns</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'gateways', 'chuffed')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-pink-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-gift text-pink-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Chuffed.org</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Social enterprise crowdfunding</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'gateways', 'thundafund')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-amber-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-bolt text-amber-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Thundafund</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">African crowdfunding platform</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'gateways', 'bank')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-slate-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-university text-slate-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Bank Transfer</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Direct wire/EFT deposits</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'gateways', 'inkind')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-rose-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-box-open text-rose-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">In-Kind Donations</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Goods, services & volunteering</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'gateways', 'other')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-gray-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-ellipsis-h text-gray-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Other/Custom</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Additional payment methods</p>
                        </div>
                    </button>
                </div>
            </div>

            <!-- CRM Integration -->
            <div class="config-card rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-6 transition-all duration-300">
                <div class="flex items-center gap-2 sm:gap-3 mb-3 sm:mb-4">
                    <div class="w-8 h-8 sm:w-10 sm:h-10 rounded-lg bg-orange-500/20 flex items-center justify-center flex-shrink-0">
                        <i class="fas fa-database text-orange-400 text-sm sm:text-base"></i>
                    </div>
                    <div>
                        <h3 class="text-sm sm:text-base md:text-lg font-semibold text-white">Donor Management (CRM)</h3>
                        <p class="text-[10px] sm:text-xs text-gray-400">Choose primary system (10 options)</p>
                    </div>
                </div>
                <p class="text-[10px] sm:text-xs text-gray-500 mb-3 italic">Sync selection determines automated follow-up logic and newsletter routing.</p>
                <div class="space-y-2 sm:space-y-3">
                    <button onclick="toggleOption(this, 'crm', 'givebutter', true)" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-yellow-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-heart text-yellow-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Givebutter</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Modern fundraising + CRM</p>
                        </div>
                        <span class="tag-badge px-1.5 sm:px-2 py-0.5 sm:py-1 rounded text-[10px] sm:text-xs flex-shrink-0">Popular</span>
                    </button>
                    
                    <button onclick="toggleOption(this, 'crm', 'donorbox', true)" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-teal-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-box text-teal-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Donorbox</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Nonprofit donation platform</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'crm', 'zeffy', true)" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-purple-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-gift text-purple-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Zeffy</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">100% free nonprofit platform</p>
                        </div>
                        <span class="tag-badge px-1.5 sm:px-2 py-0.5 sm:py-1 rounded text-[10px] sm:text-xs flex-shrink-0">Free</span>
                    </button>
                    
                    <button onclick="toggleOption(this, 'crm', 'salesforce', true)" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-blue-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fab fa-salesforce text-blue-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Salesforce NPSP</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Nonprofit Success Pack</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'crm', 'hubspot', true)" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-orange-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fab fa-hubspot text-orange-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">HubSpot</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">CRM & marketing automation</p>
                        </div>
                        <span class="tag-badge px-1.5 sm:px-2 py-0.5 sm:py-1 rounded text-[10px] sm:text-xs flex-shrink-0">Free Tier</span>
                    </button>
                    
                    <button onclick="toggleOption(this, 'crm', 'airtable', true)" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-cyan-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-table text-cyan-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Airtable</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Flexible database solution</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'crm', 'sheets', true)" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-green-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fab fa-google text-green-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Google Sheets</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Simple & accessible</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'crm', 'mailchimp', true)" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-amber-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fab fa-mailchimp text-amber-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Mailchimp</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Email marketing + donor lists</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'crm', 'zapier', true)" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-rose-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-bolt text-rose-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Zapier</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Automation & integrations</p>
                        </div>
                        <span class="tag-badge px-1.5 sm:px-2 py-0.5 sm:py-1 rounded text-[10px] sm:text-xs flex-shrink-0">Flexible</span>
                    </button>
                    
                    <button onclick="toggleOption(this, 'crm', 'none', true)" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-gray-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-user-edit text-gray-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">None/Manual</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Track donations manually</p>
                        </div>
                    </button>
                </div>
            </div>

            <!-- Functional Features -->
            <div class="config-card rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-6 transition-all duration-300">
                <div class="flex items-center gap-2 sm:gap-3 mb-3 sm:mb-4">
                    <div class="w-8 h-8 sm:w-10 sm:h-10 rounded-lg bg-orange-500/20 flex items-center justify-center flex-shrink-0">
                        <i class="fas fa-puzzle-piece text-orange-400 text-sm sm:text-base"></i>
                    </div>
                    <div>
                        <h3 class="text-sm sm:text-base md:text-lg font-semibold text-white">Functional Features</h3>
                        <p class="text-[10px] sm:text-xs text-gray-400">Select desired functionality (10 options)</p>
                    </div>
                </div>
                <div class="space-y-2 sm:space-y-3">
                    <button onclick="toggleOption(this, 'features', 'recurring')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-teal-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-sync-alt text-teal-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Recurring Support</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Monthly/annual giving options</p>
                        </div>
                        <span class="tag-badge px-1.5 sm:px-2 py-0.5 sm:py-1 rounded text-[10px] sm:text-xs flex-shrink-0">High Impact</span>
                    </button>
                    
                    <button onclick="toggleOption(this, 'features', 'project-earmarking')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-violet-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-bookmark text-violet-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Project Earmarking</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Designate funds for specific projects</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'features', 'anonymous')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-gray-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-user-secret text-gray-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Anonymous Donations</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Allow donors to remain private</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'features', 'multi-currency')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-green-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-coins text-green-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Multi-Currency</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Accept KES, USD, EUR</p>
                        </div>
                        <span class="tag-badge px-1.5 sm:px-2 py-0.5 sm:py-1 rounded text-[10px] sm:text-xs flex-shrink-0">Recommended</span>
                    </button>
                    
                    <button onclick="toggleOption(this, 'features', 'instant-receipt')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-amber-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-receipt text-amber-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Instant Thank-You Receipt</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Auto email with PDF receipt</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'features', 'donor-portal')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-blue-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-user-circle text-blue-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Donor History Portal</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Self-service donation history access</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'features', 'campaign-tracking')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-pink-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-bullseye text-pink-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Campaign Tracking</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Link donations to specific initiatives</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'features', 'impact-updates')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-emerald-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-chart-line text-emerald-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Impact Updates</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Automated donor progress reports</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'features', 'tribute-gifts')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-rose-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-gift text-rose-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Tribute/Memorial Gifts</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Donate in honor of someone</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'features', 'social-sharing')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-indigo-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-share-alt text-indigo-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Social Sharing</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Share donations on social media</p>
                        </div>
                    </button>
                </div>
            </div>

            <!-- Assets Required -->
            <div class="config-card rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-6 transition-all duration-300">
                <div class="flex items-center gap-2 sm:gap-3 mb-3 sm:mb-4">
                    <div class="w-8 h-8 sm:w-10 sm:h-10 rounded-lg bg-orange-500/20 flex items-center justify-center flex-shrink-0">
                        <i class="fas fa-folder-open text-orange-400 text-sm sm:text-base"></i>
                    </div>
                    <div>
                        <h3 class="text-sm sm:text-base md:text-lg font-semibold text-white">Assets Required</h3>
                        <p class="text-[10px] sm:text-xs text-gray-400">Mark items you have ready</p>
                    </div>
                </div>
                <div class="space-y-2 sm:space-y-3">
                    <button onclick="toggleOption(this, 'assets', 'logo-hires')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-violet-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-image text-violet-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">High-Res Logo</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">PNG/SVG for payment page</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'assets', 'impact-photos')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-cyan-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-camera text-cyan-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Impact Photos</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Community/project imagery</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'assets', 'legal-docs')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-slate-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-file-contract text-slate-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Legal Documents</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Registration, tax exemption certs</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'assets', 'bank-details')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-lime-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-university text-lime-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Bank Account Details</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">For gateway verification</p>
                        </div>
                    </button>
                    
                    <button onclick="toggleOption(this, 'assets', 'campaign-copy')" 
                            class="option-btn w-full p-2.5 sm:p-3 md:p-4 rounded-lg sm:rounded-xl flex items-center gap-2 sm:gap-3 md:gap-4 text-left">
                        <span class="config-status"><i class="fas fa-check"></i></span>
                        <div class="w-8 h-8 sm:w-9 sm:h-9 md:w-10 md:h-10 bg-fuchsia-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-pen-fancy text-fuchsia-400 text-sm sm:text-base"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <span class="font-medium text-white text-sm sm:text-base">Campaign Copy</span>
                            <p class="text-[10px] sm:text-xs text-gray-400 truncate">Donation page text & CTAs</p>
                        </div>
                    </button>
                </div>
            </div>
        </div>

        <!-- Output Section -->
        <div class="config-card rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-6 mb-4 sm:mb-6 md:mb-8">
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-3 sm:mb-4">
                <div class="flex items-center gap-2 sm:gap-3">
                    <div class="w-8 h-8 sm:w-10 sm:h-10 rounded-lg bg-orange-500/20 flex items-center justify-center flex-shrink-0">
                        <i class="fas fa-code text-orange-400 text-sm sm:text-base"></i>
                    </div>
                    <div>
                        <h3 class="text-sm sm:text-base md:text-lg font-semibold text-white">Configuration Output</h3>
                        <p class="text-[10px] sm:text-xs text-gray-400">JSON manifest for dev team</p>
                    </div>
                </div>
                <div class="flex gap-2 w-full sm:w-auto">
                    <button onclick="copyConfig()" 
                            class="copy-btn flex-1 sm:flex-none px-3 sm:px-4 py-2 rounded-lg text-white font-medium text-xs sm:text-sm transition-all duration-300 flex items-center justify-center gap-1 sm:gap-2">
                        <i class="fas fa-copy"></i>
                        <span>Copy</span>
                    </button>
                    <button onclick="downloadManifest()" 
                            class="manifest-btn flex-1 sm:flex-none px-3 sm:px-4 py-2 rounded-lg text-white font-medium text-xs sm:text-sm transition-all duration-300 flex items-center justify-center gap-1 sm:gap-2">
                        <i class="fas fa-download"></i>
                        <span class="hidden xs:inline">Download</span>
                    </button>
                </div>
            </div>
            <div class="output-box rounded-xl p-4 font-mono text-sm overflow-x-auto">
                <pre id="configOutput" class="text-orange-300">{
  "organization": "Northern Vision CBO",
  "configVersion": "2026-Q9",
  "generated": "<span class="text-gray-500">Select options above...</span>",
  "gateways": [],
  "crm": null,
  "features": [],
  "assets": {
    "ready": [],
    "needed": []
  }
}</pre>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center text-gray-500 text-xs sm:text-sm pb-6 sm:pb-8 px-2">
            <p>
                <span class="text-orange-400">Northern Vision</span><sup class="logo-cbo text-orange-500 text-[8px] sm:text-xs">CBO</sup> 
                — Internal Tool
            </p>
            <p class="mt-1 hidden sm:block">Configuration saved locally. Share JSON with dev team for implementation.</p>
            <p class="mt-1.5 sm:mt-2 text-[10px] sm:text-xs text-gray-600">
                <i class="fas fa-lock mr-1"></i> No external data transmission
            </p>
        </div>
    </div>
    </div> <!-- END main-content -->

    <!-- ========== CONFIGURATION MODAL ========== -->
    <div id="config-modal" class="modal-overlay" onclick="if(event.target === this) closeModal()">
        <div class="modal-card">
            <div class="flex items-center justify-between mb-4 sm:mb-6">
                <div class="flex items-center gap-2 sm:gap-3">
                    <div id="modal-icon" class="w-9 h-9 sm:w-12 sm:h-12 rounded-lg sm:rounded-xl bg-orange-500/20 flex items-center justify-center flex-shrink-0">
                        <i class="fas fa-cog text-orange-400 text-base sm:text-xl"></i>
                    </div>
                    <div class="min-w-0">
                        <h3 id="modal-title" class="text-base sm:text-xl font-bold text-white truncate">Configure Option</h3>
                        <p id="modal-subtitle" class="text-xs sm:text-sm text-gray-400 truncate">Enter details below</p>
                    </div>
                </div>
                <button onclick="closeModal()" class="text-gray-400 hover:text-white transition-colors p-2 -mr-2">
                    <i class="fas fa-times text-lg sm:text-xl"></i>
                </button>
            </div>
            
            <div id="modal-content" class="space-y-3 sm:space-y-4 mb-4 sm:mb-6">
                <!-- Dynamic form fields will be injected here -->
            </div>
            
            <div class="flex gap-2 sm:gap-3">
                <button onclick="closeModal()" class="modal-btn modal-btn-cancel flex-1 text-sm sm:text-base">
                    Cancel
                </button>
                <button onclick="saveModalConfig()" class="modal-btn flex-1">
                    <i class="fas fa-check mr-2"></i> Save Configuration
                </button>
            </div>
        </div>
    </div>

    <script>
        // ========== PASSWORD GATE LOGIC ==========
        // PROJECT_SECRET: Change this to your secure passphrase
        const PROJECT_SECRET = 'nv-2026';
        
        function checkPassword() {
            const input = document.getElementById('gate-password').value;
            const errorEl = document.getElementById('gate-error');
            
            if (input === PROJECT_SECRET) {
                // Successful authentication
                document.getElementById('password-gate').classList.add('hidden');
                document.getElementById('main-content').classList.add('unlocked');
                
                // Store session (expires when tab closes)
                sessionStorage.setItem('nvcbo-auth', 'true');
            } else {
                // Failed attempt
                errorEl.classList.add('show');
                document.getElementById('gate-password').value = '';
                document.getElementById('gate-password').focus();
                
                // Log failed attempt (for security audit)
                console.warn('[SECURITY] Failed auth attempt at', new Date().toISOString());
                
                setTimeout(() => {
                    errorEl.classList.remove('show');
                }, 3000);
            }
        }
        
        // Check if already authenticated in this session
        if (sessionStorage.getItem('nvcbo-auth') === 'true') {
            document.getElementById('password-gate').classList.add('hidden');
            document.getElementById('main-content').classList.add('unlocked');
        }

        // ========== CONFIGURATOR LOGIC ==========
        // Configuration state with detailed data
        const config = {
            gateways: {},
            crm: null,
            crmData: {},
            features: [],
            assets: {}
        };

        // All possible assets for tracking "needed" items
        const allAssets = ['logo-hires', 'impact-photos', 'legal-docs', 'bank-details', 'campaign-copy'];

        // Modal state
        let currentModalContext = null;

        // Gateway configuration templates
        const gatewayConfigs = {
            mpesa: {
                title: 'M-Pesa Configuration',
                subtitle: 'Safaricom mobile money setup',
                icon: 'fa-mobile-alt',
                iconBg: 'bg-green-500/20',
                iconColor: 'text-green-400',
                fields: [
                    { id: 'paybill', label: 'Paybill Number', placeholder: 'e.g., 123456', type: 'text' },
                    { id: 'till', label: 'Till Number (optional)', placeholder: 'e.g., 7890123', type: 'text' },
                    { id: 'account', label: 'Account Name', placeholder: 'e.g., Donations', type: 'text' }
                ]
            },
            paypal: {
                title: 'PayPal Configuration',
                subtitle: 'International payment setup',
                icon: 'fa-paypal',
                iconBg: 'bg-blue-500/20',
                iconColor: 'text-blue-400',
                fields: [
                    { id: 'email', label: 'Business Email', placeholder: 'payments@northernvision.org', type: 'email' },
                    { id: 'client_id', label: 'Client ID (optional)', placeholder: 'For API integration', type: 'text' }
                ]
            },
            stripe: {
                title: 'Stripe Configuration',
                subtitle: 'Card payments & digital wallets',
                icon: 'fa-stripe-s',
                iconBg: 'bg-purple-500/20',
                iconColor: 'text-purple-400',
                fields: [
                    { id: 'publishable_key', label: 'Publishable Key', placeholder: 'pk_live_...', type: 'text' },
                    { id: 'secret_key', label: 'Secret Key (for dev team)', placeholder: 'sk_live_...', type: 'password' }
                ]
            },
            flutterwave: {
                title: 'Flutterwave Configuration',
                subtitle: 'Pan-African payment gateway',
                icon: 'fa-bolt',
                iconBg: 'bg-orange-500/20',
                iconColor: 'text-orange-400',
                fields: [
                    { id: 'public_key', label: 'Public Key', placeholder: 'FLWPUBK-...', type: 'text' },
                    { id: 'secret_key', label: 'Secret Key (for dev team)', placeholder: 'FLWSECK-...', type: 'password' }
                ]
            },
            mchanga: {
                title: 'M-Changa Configuration',
                subtitle: 'Kenyan crowdfunding platform',
                icon: 'fa-hand-holding-heart',
                iconBg: 'bg-teal-500/20',
                iconColor: 'text-teal-400',
                fields: [
                    { id: 'campaign_url', label: 'Campaign Page URL', placeholder: 'https://changa.co.ke/fundraiser/...', type: 'url' },
                    { id: 'fundraiser_name', label: 'Fundraiser Name', placeholder: 'e.g., Northern Vision 2026 Appeal', type: 'text' }
                ]
            },
            payhero: {
                title: 'PayHero Kenya Configuration',
                subtitle: 'Local payment aggregator',
                icon: 'fa-rocket',
                iconBg: 'bg-indigo-500/20',
                iconColor: 'text-indigo-400',
                fields: [
                    { id: 'merchant_id', label: 'Merchant ID', placeholder: 'Your PayHero merchant ID', type: 'text' },
                    { id: 'api_key', label: 'API Key', placeholder: 'PayHero API key', type: 'password' },
                    { id: 'channel', label: 'Payment Channel', placeholder: 'e.g., MPESA, Card, Bank', type: 'text' }
                ]
            },
            pesapal: {
                title: 'Pesapal Configuration',
                subtitle: 'Multi-channel East African gateway',
                icon: 'fa-shield-alt',
                iconBg: 'bg-red-500/20',
                iconColor: 'text-red-400',
                fields: [
                    { id: 'consumer_key', label: 'Consumer Key', placeholder: 'Your Pesapal consumer key', type: 'text' },
                    { id: 'consumer_secret', label: 'Consumer Secret', placeholder: 'Your Pesapal consumer secret', type: 'password' },
                    { id: 'ipn_url', label: 'IPN Callback URL (optional)', placeholder: 'https://yoursite.com/ipn', type: 'url' }
                ]
            },
            globalgiving: {
                title: 'GlobalGiving Configuration',
                subtitle: 'Vetted nonprofit fundraising',
                icon: 'fa-globe-africa',
                iconBg: 'bg-emerald-500/20',
                iconColor: 'text-emerald-400',
                fields: [
                    { id: 'project_id', label: 'Project ID', placeholder: 'e.g., 12345', type: 'text' },
                    { id: 'project_url', label: 'Project Page URL', placeholder: 'https://www.globalgiving.org/projects/...', type: 'url' },
                    { id: 'api_key', label: 'API Key (optional)', placeholder: 'For donation tracking', type: 'text' }
                ]
            },
            gofundme: {
                title: 'GoFundMe Configuration',
                subtitle: 'Global crowdfunding campaigns',
                icon: 'fa-heart',
                iconBg: 'bg-lime-500/20',
                iconColor: 'text-lime-400',
                fields: [
                    { id: 'campaign_url', label: 'Campaign URL', placeholder: 'https://gofundme.com/f/...', type: 'url' },
                    { id: 'campaign_title', label: 'Campaign Title', placeholder: 'e.g., Support Northern Kenya Communities', type: 'text' }
                ]
            },
            chuffed: {
                title: 'Chuffed.org Configuration',
                subtitle: 'Social enterprise crowdfunding',
                icon: 'fa-gift',
                iconBg: 'bg-pink-500/20',
                iconColor: 'text-pink-400',
                fields: [
                    { id: 'campaign_url', label: 'Campaign URL', placeholder: 'https://chuffed.org/project/...', type: 'url' },
                    { id: 'campaign_name', label: 'Campaign Name', placeholder: 'Your campaign name on Chuffed', type: 'text' }
                ]
            },
            thundafund: {
                title: 'Thundafund Configuration',
                subtitle: 'African crowdfunding platform',
                icon: 'fa-bolt',
                iconBg: 'bg-amber-500/20',
                iconColor: 'text-amber-400',
                fields: [
                    { id: 'project_url', label: 'Project URL', placeholder: 'https://www.thundafund.com/project/...', type: 'url' },
                    { id: 'project_name', label: 'Project Name', placeholder: 'Your Thundafund project name', type: 'text' }
                ]
            },
            bank: {
                title: 'Bank Transfer Details',
                subtitle: 'Direct wire/EFT deposits',
                icon: 'fa-university',
                iconBg: 'bg-slate-500/20',
                iconColor: 'text-slate-400',
                fields: [
                    { id: 'bank_name', label: 'Bank Name', placeholder: 'e.g., Equity Bank Kenya', type: 'text' },
                    { id: 'account_name', label: 'Account Name', placeholder: 'Northern Vision CBO', type: 'text' },
                    { id: 'account_number', label: 'Account Number', placeholder: '0123456789012', type: 'text' },
                    { id: 'branch_code', label: 'Branch / SWIFT Code', placeholder: 'e.g., EABORBIXX', type: 'text' },
                    { id: 'currency', label: 'Currency', placeholder: 'KES / USD / EUR', type: 'text' }
                ]
            },
            inkind: {
                title: 'In-Kind Donations',
                subtitle: 'Goods, services & volunteering',
                icon: 'fa-box-open',
                iconBg: 'bg-rose-500/20',
                iconColor: 'text-rose-400',
                fields: [
                    { id: 'contact_email', label: 'Coordination Email', placeholder: 'inkind@northernvision.org', type: 'email' },
                    { id: 'accepted_types', label: 'Accepted Donation Types', placeholder: 'e.g., School supplies, medical equipment, vehicles...', type: 'textarea' },
                    { id: 'dropoff_location', label: 'Drop-off Location', placeholder: 'Physical address for item donations', type: 'text' }
                ]
            },
            other: {
                title: 'Other/Custom Payment Method',
                subtitle: 'Additional payment channels',
                icon: 'fa-ellipsis-h',
                iconBg: 'bg-gray-500/20',
                iconColor: 'text-gray-400',
                fields: [
                    { id: 'method_name', label: 'Payment Method Name', placeholder: 'e.g., Cryptocurrency, Wire Transfer', type: 'text' },
                    { id: 'description', label: 'Description', placeholder: 'Describe this payment method', type: 'textarea' },
                    { id: 'contact_info', label: 'Contact/Instructions', placeholder: 'How donors can use this method', type: 'textarea' }
                ]
            }
        };

        // CRM configuration templates
        const crmConfigs = {
            givebutter: {
                title: 'Givebutter',
                subtitle: 'Modern fundraising + CRM',
                icon: 'fa-heart',
                iconBg: 'bg-yellow-500/20',
                iconColor: 'text-yellow-400',
                fields: [
                    { id: 'account_id', label: 'Account ID', placeholder: 'Your Givebutter account ID', type: 'text' },
                    { id: 'campaign_url', label: 'Campaign URL', placeholder: 'https://givebutter.com/...', type: 'url' },
                    { id: 'api_key', label: 'API Key (optional)', placeholder: 'For webhook integration', type: 'text' }
                ]
            },
            donorbox: {
                title: 'Donorbox',
                subtitle: 'Nonprofit donation platform',
                icon: 'fa-box',
                iconBg: 'bg-teal-500/20',
                iconColor: 'text-teal-400',
                fields: [
                    { id: 'org_slug', label: 'Organization Slug', placeholder: 'Your Donorbox org name', type: 'text' },
                    { id: 'campaign_url', label: 'Donation Form URL', placeholder: 'https://donorbox.org/...', type: 'url' },
                    { id: 'api_key', label: 'API Key (optional)', placeholder: 'For automation', type: 'text' }
                ]
            },
            zeffy: {
                title: 'Zeffy',
                subtitle: '100% free nonprofit platform',
                icon: 'fa-gift',
                iconBg: 'bg-purple-500/20',
                iconColor: 'text-purple-400',
                fields: [
                    { id: 'org_name', label: 'Organization Name', placeholder: 'Northern Vision CBO', type: 'text' },
                    { id: 'donation_page', label: 'Donation Page URL', placeholder: 'https://www.zeffy.com/...', type: 'url' }
                ]
            },
            salesforce: {
                title: 'Salesforce NPSP',
                subtitle: 'Nonprofit Success Pack setup',
                icon: 'fa-salesforce',
                iconBg: 'bg-blue-500/20',
                iconColor: 'text-blue-400',
                fields: [
                    { id: 'org_id', label: 'Organization ID', placeholder: '00D...', type: 'text' },
                    { id: 'username', label: 'Integration Username', placeholder: 'api@northernvision.org', type: 'email' }
                ]
            },
            hubspot: {
                title: 'HubSpot',
                subtitle: 'CRM & marketing automation',
                icon: 'fa-hubspot',
                iconBg: 'bg-orange-500/20',
                iconColor: 'text-orange-400',
                fields: [
                    { id: 'portal_id', label: 'Portal ID', placeholder: 'e.g., 12345678', type: 'text' },
                    { id: 'api_key', label: 'API Key (optional)', placeholder: 'For automation', type: 'text' }
                ]
            },
            airtable: {
                title: 'Airtable Database',
                subtitle: 'Flexible donor tracking',
                icon: 'fa-table',
                iconBg: 'bg-cyan-500/20',
                iconColor: 'text-cyan-400',
                fields: [
                    { id: 'base_id', label: 'Base ID', placeholder: 'app...', type: 'text' },
                    { id: 'table_name', label: 'Donors Table Name', placeholder: 'e.g., Donors', type: 'text' }
                ]
            },
            sheets: {
                title: 'Google Sheets',
                subtitle: 'Simple spreadsheet tracking',
                icon: 'fa-google',
                iconBg: 'bg-green-500/20',
                iconColor: 'text-green-400',
                fields: [
                    { id: 'sheet_url', label: 'Spreadsheet URL', placeholder: 'https://docs.google.com/spreadsheets/d/...', type: 'url' },
                    { id: 'sheet_name', label: 'Sheet Tab Name', placeholder: 'e.g., 2026 Donations', type: 'text' }
                ]
            },
            mailchimp: {
                title: 'Mailchimp',
                subtitle: 'Email marketing + donor lists',
                icon: 'fa-mailchimp',
                iconBg: 'bg-amber-500/20',
                iconColor: 'text-amber-400',
                fields: [
                    { id: 'list_id', label: 'Audience/List ID', placeholder: 'Your Mailchimp list ID', type: 'text' },
                    { id: 'api_key', label: 'API Key', placeholder: 'Your Mailchimp API key', type: 'password' },
                    { id: 'server_prefix', label: 'Server Prefix', placeholder: 'e.g., us19', type: 'text' }
                ]
            },
            zapier: {
                title: 'Zapier',
                subtitle: 'Automation & integrations',
                icon: 'fa-bolt',
                iconBg: 'bg-rose-500/20',
                iconColor: 'text-rose-400',
                fields: [
                    { id: 'webhook_url', label: 'Webhook URL', placeholder: 'https://hooks.zapier.com/...', type: 'url' },
                    { id: 'trigger_event', label: 'Trigger Event', placeholder: 'e.g., New Donation, Recurring Payment', type: 'text' },
                    { id: 'notes', label: 'Integration Notes', placeholder: 'Describe the automation workflow', type: 'textarea' }
                ]
            },
            none: {
                title: 'None/Manual Tracking',
                subtitle: 'No automated CRM sync',
                icon: 'fa-user-edit',
                iconBg: 'bg-gray-500/20',
                iconColor: 'text-gray-400',
                fields: [
                    { id: 'responsible_person', label: 'Responsible Person', placeholder: 'Who manages donor records?', type: 'text' },
                    { id: 'tracking_method', label: 'Tracking Method', placeholder: 'e.g., Excel file, paper records', type: 'text' },
                    { id: 'notes', label: 'Additional Notes', placeholder: 'Any special instructions', type: 'textarea' }
                ]
            }
        };

        // Asset configuration templates
        const assetConfigs = {
            'logo-hires': {
                title: 'High-Resolution Logo',
                subtitle: 'Branding for payment pages',
                icon: 'fa-image',
                iconBg: 'bg-violet-500/20',
                iconColor: 'text-violet-400',
                fields: [
                    { id: 'url', label: 'Logo URL (PNG/SVG)', placeholder: 'https://drive.google.com/...', type: 'url' },
                    { id: 'notes', label: 'Notes', placeholder: 'Preferred dimensions, variants, etc.', type: 'textarea' }
                ]
            },
            'impact-photos': {
                title: 'Impact Photos',
                subtitle: 'Community & project imagery',
                icon: 'fa-camera',
                iconBg: 'bg-cyan-500/20',
                iconColor: 'text-cyan-400',
                fields: [
                    { id: 'folder_url', label: 'Photos Folder URL', placeholder: 'https://drive.google.com/drive/folders/...', type: 'url' },
                    { id: 'count', label: 'Number of Photos Ready', placeholder: 'e.g., 15', type: 'number' }
                ]
            },
            'legal-docs': {
                title: 'Legal Documents',
                subtitle: 'Registration & tax certificates',
                icon: 'fa-file-contract',
                iconBg: 'bg-slate-500/20',
                iconColor: 'text-slate-400',
                fields: [
                    { id: 'registration_url', label: 'CBO Registration Certificate', placeholder: 'https://...', type: 'url' },
                    { id: 'tax_url', label: 'KRA PIN / Tax Exemption', placeholder: 'https://...', type: 'url' }
                ]
            },
            'bank-details': {
                title: 'Bank Account Details',
                subtitle: 'For gateway verification',
                icon: 'fa-university',
                iconBg: 'bg-lime-500/20',
                iconColor: 'text-lime-400',
                fields: [
                    { id: 'bank_name', label: 'Bank Name', placeholder: 'e.g., Equity Bank', type: 'text' },
                    { id: 'account_name', label: 'Account Name', placeholder: 'Northern Vision CBO', type: 'text' },
                    { id: 'account_number', label: 'Account Number', placeholder: '0123456789', type: 'text' },
                    { id: 'branch', label: 'Branch', placeholder: 'e.g., Isiolo Branch', type: 'text' }
                ]
            },
            'campaign-copy': {
                title: 'Campaign Copy',
                subtitle: 'Donation page text & CTAs',
                icon: 'fa-pen-fancy',
                iconBg: 'bg-fuchsia-500/20',
                iconColor: 'text-fuchsia-400',
                fields: [
                    { id: 'headline', label: 'Main Headline', placeholder: 'Support Northern Kenya Communities', type: 'text' },
                    { id: 'description', label: 'Description', placeholder: 'Your donation helps...', type: 'textarea' },
                    { id: 'cta_text', label: 'Button Text', placeholder: 'e.g., Donate Now', type: 'text' }
                ]
            }
        };

        // Feature descriptions
        const featureConfigs = {
            recurring: { title: 'Recurring Support', desc: 'Monthly/annual giving options' },
            'project-earmarking': { title: 'Project Earmarking', desc: 'Designate funds for specific projects' },
            anonymous: { title: 'Anonymous Donations', desc: 'Allow donors to remain private' },
            'multi-currency': { title: 'Multi-Currency', desc: 'Accept KES, USD, EUR' },
            'instant-receipt': { title: 'Instant Thank-You Receipt', desc: 'Auto email with PDF receipt' },
            'donor-portal': { title: 'Donor History Portal', desc: 'Self-service donation history access' },
            'campaign-tracking': { title: 'Campaign Tracking', desc: 'Link donations to specific initiatives' },
            'impact-updates': { title: 'Impact Updates', desc: 'Automated donor progress reports' },
            'tribute-gifts': { title: 'Tribute/Memorial Gifts', desc: 'Donate in honor of someone' },
            'social-sharing': { title: 'Social Sharing', desc: 'Share donations on social media' }
        };

        function toggleOption(btn, category, value, singleSelect = false) {
            if (category === 'gateways' && gatewayConfigs[value]) {
                // Open modal for gateway configuration
                openModal('gateway', value, btn);
            } else if (category === 'crm' && crmConfigs[value]) {
                // For CRM, handle single select first
                if (singleSelect) {
                    const container = btn.parentElement;
                    container.querySelectorAll('.option-btn').forEach(b => {
                        b.classList.remove('selected', 'configured');
                    });
                }
                openModal('crm', value, btn);
            } else if (category === 'assets' && assetConfigs[value]) {
                // Open modal for asset configuration
                openModal('asset', value, btn);
            } else if (category === 'features') {
                // Features are simple toggles (no modal needed)
                btn.classList.toggle('selected');
                btn.classList.toggle('configured');
                if (btn.classList.contains('selected')) {
                    if (!config.features.includes(value)) {
                        config.features.push(value);
                    }
                } else {
                    config.features = config.features.filter(v => v !== value);
                }
                updateOutput();
            }
        }

        function openModal(type, value, btn) {
            let configTemplate;
            let category;
            
            if (type === 'gateway') {
                configTemplate = gatewayConfigs[value];
                category = 'gateways';
            } else if (type === 'crm') {
                configTemplate = crmConfigs[value];
                category = 'crm';
            } else if (type === 'asset') {
                configTemplate = assetConfigs[value];
                category = 'assets';
            }
            
            if (!configTemplate) return;
            
            currentModalContext = { type, value, btn, category };
            
            // Update modal header
            document.getElementById('modal-title').textContent = configTemplate.title;
            document.getElementById('modal-subtitle').textContent = configTemplate.subtitle;
            
            const iconEl = document.getElementById('modal-icon');
            iconEl.className = `w-12 h-12 rounded-xl ${configTemplate.iconBg} flex items-center justify-center`;
            
            // Determine if it's a brand icon (fab) or solid icon (fas)
            const brandIcons = ['fa-paypal', 'fa-stripe-s', 'fa-salesforce', 'fa-hubspot', 'fa-google'];
            const iconPrefix = brandIcons.includes(configTemplate.icon) ? 'fab' : 'fas';
            iconEl.innerHTML = `<i class="${iconPrefix} ${configTemplate.icon} ${configTemplate.iconColor} text-xl"></i>`;
            
            // Build form fields
            const contentEl = document.getElementById('modal-content');
            let fieldsHTML = '';
            
            // Get existing data if any
            let existingData = {};
            if (type === 'gateway' && config.gateways[value]) {
                existingData = config.gateways[value];
            } else if (type === 'crm' && config.crmData[value]) {
                existingData = config.crmData[value];
            } else if (type === 'asset' && config.assets[value]) {
                existingData = config.assets[value];
            }
            
            configTemplate.fields.forEach(field => {
                const existingValue = existingData[field.id] || '';
                if (field.type === 'textarea') {
                    fieldsHTML += `
                        <div>
                            <label class="modal-label">${field.label}</label>
                            <textarea 
                                id="modal-field-${field.id}" 
                                class="modal-input" 
                                placeholder="${field.placeholder}"
                                rows="3"
                            >${existingValue}</textarea>
                        </div>
                    `;
                } else {
                    fieldsHTML += `
                        <div>
                            <label class="modal-label">${field.label}</label>
                            <input 
                                type="${field.type}" 
                                id="modal-field-${field.id}" 
                                class="modal-input" 
                                placeholder="${field.placeholder}"
                                value="${existingValue}"
                            >
                        </div>
                    `;
                }
            });
            
            contentEl.innerHTML = fieldsHTML;
            
            // Show modal
            document.getElementById('config-modal').classList.add('active');
            
            // Focus first field
            const firstInput = contentEl.querySelector('input, textarea');
            if (firstInput) setTimeout(() => firstInput.focus(), 100);
        }

        function closeModal() {
            document.getElementById('config-modal').classList.remove('active');
            currentModalContext = null;
        }

        function saveModalConfig() {
            if (!currentModalContext) return;
            
            const { type, value, btn, category } = currentModalContext;
            let configTemplate;
            
            if (type === 'gateway') {
                configTemplate = gatewayConfigs[value];
            } else if (type === 'crm') {
                configTemplate = crmConfigs[value];
            } else if (type === 'asset') {
                configTemplate = assetConfigs[value];
            }
            
            // Collect form data
            const data = {};
            let hasData = false;
            
            configTemplate.fields.forEach(field => {
                const el = document.getElementById(`modal-field-${field.id}`);
                if (el && el.value.trim()) {
                    data[field.id] = el.value.trim();
                    hasData = true;
                }
            });
            
            // Save to config
            if (type === 'gateway') {
                if (hasData) {
                    config.gateways[value] = data;
                    btn.classList.add('selected', 'configured');
                } else {
                    delete config.gateways[value];
                    btn.classList.remove('selected', 'configured');
                }
            } else if (type === 'crm') {
                if (hasData) {
                    config.crm = value;
                    config.crmData[value] = data;
                    btn.classList.add('selected', 'configured');
                } else {
                    config.crm = null;
                    delete config.crmData[value];
                    btn.classList.remove('selected', 'configured');
                }
            } else if (type === 'asset') {
                if (hasData) {
                    config.assets[value] = data;
                    btn.classList.add('selected', 'configured');
                } else {
                    delete config.assets[value];
                    btn.classList.remove('selected', 'configured');
                }
            }
            
            closeModal();
            updateOutput();
        }

        // Close modal on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeModal();
        });

        function updateOutput() {
            const output = {
                organization: "Northern Vision CBO",
                configVersion: "2026-Q9",
                generated: new Date().toISOString(),
                gateways: config.gateways,
                crm: config.crm ? { provider: config.crm, ...config.crmData[config.crm] } : null,
                features: config.features,
                assets: config.assets,
                metadata: {
                    totalGateways: Object.keys(config.gateways).length,
                    featuresEnabled: config.features.length,
                    assetsReady: Object.keys(config.assets).length,
                    completionPercent: calculateCompletion()
                }
            };

            document.getElementById('configOutput').textContent = JSON.stringify(output, null, 2);
        }

        function calculateCompletion() {
            let score = 0;
            let total = 4;
            
            if (Object.keys(config.gateways).length > 0) score++;
            if (config.crm) score++;
            if (config.features.length > 0) score++;
            if (Object.keys(config.assets).length >= 3) score++;
            
            return Math.round((score / total) * 100);
        }

        function copyConfig() {
            const output = document.getElementById('configOutput').textContent;
            navigator.clipboard.writeText(output).then(() => {
                // Visual feedback
                const btn = document.querySelector('.copy-btn');
                const originalText = btn.innerHTML;
                btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
                btn.style.background = 'linear-gradient(135deg, #16a34a, #15803d)';
                
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.style.background = '';
                }, 2000);
            });
        }

        function downloadManifest() {
            const output = document.getElementById('configOutput').textContent;
            const blob = new Blob([output], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `nvcbo-donate-config-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Initialize output
        updateOutput();
    </script>
</body>
</html>
